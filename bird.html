<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Flappy Bird - More Space Edition</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            touch-action: manipulation;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            font-family: 'Courier New', monospace;
            background-color: #70c5ce;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            overflow: hidden;
            user-select: none;
        }
        
        #game-container {
            width: 100%;
            max-width: 400px;
            height: 600px;
            position: relative;
            overflow: hidden;
            background-color: #70c5ce;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.3);
            border-radius: 10px;
        }
        
        #game-canvas {
            width: 100%;
            height: 100%;
            display: block;
        }
        
        #ui-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }
        
        #score-display {
            position: absolute;
            top: 20px;
            width: 100%;
            text-align: center;
            font-size: 60px;
            font-weight: bold;
            color: white;
            text-shadow: 2px 2px 0 #000;
            z-index: 10;
        }
        
        #game-over {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 20;
            display: none;
        }
        
        #game-over h2 {
            color: white;
            font-size: 40px;
            margin-bottom: 20px;
            text-shadow: 2px 2px 0 #000;
        }
        
        #final-score {
            color: white;
            font-size: 60px;
            font-weight: bold;
            margin-bottom: 30px;
            text-shadow: 2px 2px 0 #000;
        }
        
        #high-score {
            color: #f0c419;
            font-size: 24px;
            margin-bottom: 30px;
            text-shadow: 1px 1px 0 #000;
        }
        
        #restart-btn {
            background-color: #f0c419;
            color: #8a6d0f;
            border: none;
            padding: 15px 30px;
            font-size: 24px;
            font-weight: bold;
            border-radius: 10px;
            cursor: pointer;
            pointer-events: auto;
            box-shadow: 0 5px 0 #8a6d0f;
            transition: transform 0.1s;
        }
        
        #restart-btn:active {
            transform: translateY(5px);
            box-shadow: none;
        }
        
        #start-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 30;
        }
        
        #start-screen h1 {
            color: white;
            font-size: 50px;
            margin-bottom: 10px;
            text-shadow: 3px 3px 0 #000;
        }
        
        #start-screen p {
            color: white;
            font-size: 20px;
            margin-bottom: 40px;
            text-align: center;
            padding: 0 20px;
            text-shadow: 1px 1px 0 #000;
        }
        
        #start-btn {
            background-color: #f0c419;
            color: #8a6d0f;
            border: none;
            padding: 15px 40px;
            font-size: 28px;
            font-weight: bold;
            border-radius: 10px;
            cursor: pointer;
            pointer-events: auto;
            box-shadow: 0 5px 0 #8a6d0f;
            transition: transform 0.1s;
        }
        
        #start-btn:active {
            transform: translateY(5px);
            box-shadow: none;
        }
        
        #instructions {
            position: absolute;
            bottom: 20px;
            width: 100%;
            text-align: center;
            color: white;
            font-size: 18px;
            text-shadow: 1px 1px 0 #000;
            padding: 0 20px;
        }
        
        #difficulty-indicator {
            position: absolute;
            top: 100px;
            width: 100%;
            text-align: center;
            color: white;
            font-size: 16px;
            text-shadow: 1px 1px 0 #000;
            opacity: 0.8;
        }
        
        @media (max-height: 650px) {
            #game-container {
                height: 100vh;
                max-height: 600px;
                border-radius: 0;
            }
            
            #score-display {
                font-size: 50px;
            }
            
            #game-over h2 {
                font-size: 30px;
            }
            
            #final-score {
                font-size: 50px;
            }
        }
    </style>
</head>
<body>
    <div id="game-container">
        <canvas id="game-canvas"></canvas>
        
        <div id="ui-overlay">
            <div id="score-display">0</div>
            <div id="difficulty-indicator">Distance: WIDE</div>
            
            <div id="game-over">
                <h2>GAME OVER</h2>
                <div id="final-score">0</div>
                <div id="high-score">High Score: 0</div>
                <button id="restart-btn">PLAY AGAIN</button>
            </div>
            
            <div id="start-screen">
                <h1>FLAPPY BIRD</h1>
                <p>More space between pipes! Tap to fly through wider gaps.</p>
                <button id="start-btn">START</button>
                <div id="instructions">Tap anywhere to fly</div>
            </div>
        </div>
    </div>

    <script>
        // Game elements
        const canvas = document.getElementById('game-canvas');
        const ctx = canvas.getContext('2d');
        const scoreDisplay = document.getElementById('score-display');
        const difficultyIndicator = document.getElementById('difficulty-indicator');
        const gameOverScreen = document.getElementById('game-over');
        const finalScoreDisplay = document.getElementById('final-score');
        const highScoreDisplay = document.getElementById('high-score');
        const restartBtn = document.getElementById('restart-btn');
        const startScreen = document.getElementById('start-screen');
        const startBtn = document.getElementById('start-btn');
        const instructions = document.getElementById('instructions');
        
        // Set canvas size to match container
        function resizeCanvas() {
            canvas.width = canvas.clientWidth;
            canvas.height = canvas.clientHeight;
        }
        
        // Game variables
        let game = {
            running: false,
            score: 0,
            highScore: localStorage.getItem('flappyHighScore') || 0,
            gravity: 0.5,
            speed: 3,
            pipeGap: 200, // Wider initial gap (increased from 160)
            pipeFrequency: 180, // Reduced frequency (more space between pipes)
            minGap: 180, // Minimum gap size
            maxGap: 250  // Maximum gap size for variety
        };
        
        // Bird properties
        let bird = {
            x: 100,
            y: canvas.height / 2,
            width: 40,
            height: 30,
            velocity: 0,
            jump: -10,
            color: '#f0c419',
            draw: function() {
                ctx.fillStyle = this.color;
                
                // Draw bird body
                ctx.beginPath();
                ctx.ellipse(this.x, this.y, this.width/2, this.height/2, 0, 0, Math.PI * 2);
                ctx.fill();
                
                // Draw bird eye
                ctx.fillStyle = 'white';
                ctx.beginPath();
                ctx.arc(this.x + 10, this.y - 5, 6, 0, Math.PI * 2);
                ctx.fill();
                
                ctx.fillStyle = 'black';
                ctx.beginPath();
                ctx.arc(this.x + 12, this.y - 5, 3, 0, Math.PI * 2);
                ctx.fill();
                
                // Draw bird beak
                ctx.fillStyle = '#ff6600';
                ctx.beginPath();
                ctx.moveTo(this.x + 20, this.y);
                ctx.lineTo(this.x + 35, this.y);
                ctx.lineTo(this.x + 20, this.y + 10);
                ctx.fill();
                
                // Draw bird wing
                ctx.fillStyle = '#e0b018';
                ctx.beginPath();
                ctx.ellipse(this.x - 5, this.y + 5, 15, 10, Math.PI/4, 0, Math.PI * 2);
                ctx.fill();
            },
            flap: function() {
                this.velocity = this.jump;
            },
            update: function() {
                // Apply gravity
                this.velocity += game.gravity;
                this.y += this.velocity;
                
                // Floor collision
                if (this.y + this.height/2 >= canvas.height - ground.height) {
                    this.y = canvas.height - ground.height - this.height/2;
                    if (game.running) {
                        endGame();
                    }
                }
                
                // Ceiling collision
                if (this.y - this.height/2 <= 0) {
                    this.y = this.height/2;
                    this.velocity = 0;
                }
            },
            reset: function() {
                this.y = canvas.height / 2;
                this.velocity = 0;
            }
        };
        
        // Pipe properties
        let pipes = [];
        const pipeWidth = 60;
        let pipeCounter = 0;
        
        // Ground properties
        let ground = {
            height: 80,
            draw: function() {
                // Draw ground
                ctx.fillStyle = '#dece7b';
                ctx.fillRect(0, canvas.height - this.height, canvas.width, this.height);
                
                // Draw grass
                ctx.fillStyle = '#8aab0e';
                ctx.fillRect(0, canvas.height - this.height, canvas.width, 10);
                
                // Draw ground pattern
                ctx.fillStyle = '#d0be6b';
                for (let i = 0; i < canvas.width; i += 40) {
                    ctx.fillRect(i, canvas.height - 20, 20, 5);
                }
            }
        };
        
        // Cloud properties
        let clouds = [];
        const cloudCount = 5; // Increased cloud count for more visual interest
        
        // Initialize clouds
        function initClouds() {
            clouds = [];
            for (let i = 0; i < cloudCount; i++) {
                clouds.push({
                    x: Math.random() * canvas.width,
                    y: Math.random() * (canvas.height / 2),
                    width: 60 + Math.random() * 50,
                    height: 30 + Math.random() * 30,
                    speed: 0.3 + Math.random() * 0.7
                });
            }
        }
        
        // Draw clouds
        function drawClouds() {
            ctx.fillStyle = 'rgba(255, 255, 255, 0.8)';
            clouds.forEach(cloud => {
                ctx.beginPath();
                ctx.ellipse(cloud.x, cloud.y, cloud.width/2, cloud.height/2, 0, 0, Math.PI * 2);
                ctx.fill();
                
                // Add cloud details
                ctx.beginPath();
                ctx.ellipse(cloud.x - cloud.width/4, cloud.y, cloud.width/3, cloud.height/2, 0, 0, Math.PI * 2);
                ctx.fill();
                
                ctx.beginPath();
                ctx.ellipse(cloud.x + cloud.width/4, cloud.y, cloud.width/3, cloud.height/2, 0, 0, Math.PI * 2);
                ctx.fill();
            });
        }
        
        // Update clouds
        function updateClouds() {
            clouds.forEach(cloud => {
                cloud.x -= cloud.speed;
                if (cloud.x + cloud.width < 0) {
                    cloud.x = canvas.width + cloud.width;
                    cloud.y = Math.random() * (canvas.height / 2);
                }
            });
        }
        
        // Create a new pipe with variable gap size
        function createPipe() {
            // Random gap size between min and max
            const currentGap = game.minGap + Math.random() * (game.maxGap - game.minGap);
            
            // Random pipe height with more space at top and bottom
            const minPipeHeight = 80;
            const maxPipeHeight = canvas.height - currentGap - ground.height - minPipeHeight;
            const pipeHeight = Math.floor(Math.random() * (maxPipeHeight - minPipeHeight)) + minPipeHeight;
            
            pipes.push({
                x: canvas.width,
                topHeight: pipeHeight,
                bottomY: pipeHeight + currentGap,
                gapSize: currentGap,
                passed: false,
                width: pipeWidth,
                draw: function() {
                    // Draw top pipe
                    ctx.fillStyle = '#6aab0e';
                    ctx.fillRect(this.x, 0, this.width, this.topHeight);
                    
                    // Draw pipe cap
                    ctx.fillStyle = '#5a9a0a';
                    ctx.fillRect(this.x - 5, this.topHeight - 20, this.width + 10, 20);
                    
                    // Draw bottom pipe
                    ctx.fillStyle = '#6aab0e';
                    ctx.fillRect(this.x, this.bottomY, this.width, canvas.height - this.bottomY - ground.height);
                    
                    // Draw pipe cap
                    ctx.fillStyle = '#5a9a0a';
                    ctx.fillRect(this.x - 5, this.bottomY, this.width + 10, 20);
                    
                    // Draw gap indicator (visual aid)
                    ctx.fillStyle = 'rgba(255, 255, 255, 0.2)';
                    ctx.fillRect(this.x, this.topHeight, this.width, currentGap);
                },
                update: function() {
                    this.x -= game.speed;
                    
                    // Check if bird passed the pipe
                    if (!this.passed && this.x + this.width < bird.x) {
                        this.passed = true;
                        game.score++;
                        scoreDisplay.textContent = game.score;
                        
                        // Update difficulty indicator based on gap size
                        updateDifficultyIndicator(currentGap);
                    }
                    
                    // Check collision with bird
                    if (
                        bird.x + bird.width/2 > this.x &&
                        bird.x - bird.width/2 < this.x + this.width &&
                        (
                            bird.y - bird.height/2 < this.topHeight ||
                            bird.y + bird.height/2 > this.bottomY
                        )
                    ) {
                        endGame();
                    }
                }
            });
        }
        
        // Update difficulty indicator
        function updateDifficultyIndicator(gapSize) {
            let difficultyText = "Distance: ";
            if (gapSize >= 230) {
                difficultyText += "VERY WIDE";
                difficultyIndicator.style.color = "#4CAF50"; // Green
            } else if (gapSize >= 210) {
                difficultyText += "WIDE";
                difficultyIndicator.style.color = "#8BC34A"; // Light green
            } else if (gapSize >= 190) {
                difficultyText += "MEDIUM";
                difficultyIndicator.style.color = "#FFC107"; // Amber
            } else {
                difficultyText += "NARROW";
                difficultyIndicator.style.color = "#FF9800"; // Orange
            }
            difficultyIndicator.textContent = difficultyText;
        }
        
        // Draw all pipes
        function drawPipes() {
            pipes.forEach(pipe => pipe.draw());
        }
        
        // Update all pipes
        function updatePipes() {
            pipes.forEach(pipe => pipe.update());
            
            // Remove pipes that are off screen
            pipes = pipes.filter(pipe => pipe.x + pipe.width > 0);
            
            // Create new pipes with variable frequency
            pipeCounter++;
            if (pipeCounter > game.pipeFrequency) {
                createPipe();
                pipeCounter = 0;
                
                // Gradually increase speed but not too fast
                if (game.speed < 6) {
                    game.speed += 0.03;
                }
                
                // Gradually reduce gap size as score increases, but keep it reasonable
                if (game.score > 10 && game.minGap > 150) {
                    game.minGap -= 0.5;
                    game.maxGap -= 0.5;
                }
            }
        }
        
        // Draw background
        function drawBackground() {
            // Sky gradient
            const gradient = ctx.createLinearGradient(0, 0, 0, canvas.height);
            gradient.addColorStop(0, '#87CEEB');
            gradient.addColorStop(1, '#70c5ce');
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // Draw clouds
            drawClouds();
            
            // Draw distant mountains for visual interest
            ctx.fillStyle = 'rgba(100, 130, 100, 0.3)';
            ctx.beginPath();
            ctx.moveTo(0, canvas.height * 0.6);
            ctx.lineTo(canvas.width * 0.3, canvas.height * 0.4);
            ctx.lineTo(canvas.width * 0.6, canvas.height * 0.5);
            ctx.lineTo(canvas.width, canvas.height * 0.55);
            ctx.lineTo(canvas.width, canvas.height);
            ctx.lineTo(0, canvas.height);
            ctx.closePath();
            ctx.fill();
        }
        
        // Game loop
        function gameLoop() {
            // Clear canvas
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Draw background
            drawBackground();
            
            // Draw pipes
            drawPipes();
            
            // Draw ground
            ground.draw();
            
            // Draw bird
            bird.draw();
            
            // Update game elements if running
            if (game.running) {
                bird.update();
                updatePipes();
                updateClouds();
            }
            
            // Continue game loop
            requestAnimationFrame(gameLoop);
        }
        
        // Start game
        function startGame() {
            game.running = true;
            game.score = 0;
            game.speed = 3;
            game.pipeGap = 200; // Reset to wider gap
            game.minGap = 180;
            game.maxGap = 250;
            game.pipeFrequency = 180; // More space between pipes
            scoreDisplay.textContent = '0';
            updateDifficultyIndicator(200);
            
            // Reset game objects
            bird.reset();
            pipes = [];
            pipeCounter = 0;
            
            // Hide start screen
            startScreen.style.display = 'none';
            instructions.textContent = "Tap to fly through the gaps!";
        }
        
        // End game
        function endGame() {
            game.running = false;
            
            // Update high score
            if (game.score > game.highScore) {
                game.highScore = game.score;
                localStorage.setItem('flappyHighScore', game.highScore);
            }
            
            // Show game over screen
            finalScoreDisplay.textContent = game.score;
            highScoreDisplay.textContent = `High Score: ${game.highScore}`;
            gameOverScreen.style.display = 'flex';
        }
        
        // Restart game
        function restartGame() {
            gameOverScreen.style.display = 'none';
            startGame();
        }
        
        // Handle user input
        function handleInput() {
            if (!game.running) return;
            
            bird.flap();
        }
        
        // Event listeners
        startBtn.addEventListener('click', startGame);
        restartBtn.addEventListener('click', restartGame);
        
        // Touch and click controls
        canvas.addEventListener('click', handleInput);
        canvas.addEventListener('touchstart', function(e) {
            e.preventDefault();
            handleInput();
        });
        
        // Also allow tapping anywhere on the screen
        document.addEventListener('click', function(e) {
            if (e.target.id !== 'start-btn' && e.target.id !== 'restart-btn' && game.running) {
                handleInput();
            }
        });
        
        // Handle window resize
        window.addEventListener('resize', function() {
            resizeCanvas();
            bird.y = canvas.height / 2;
            initClouds();
        });
        
        // Initialize game
        resizeCanvas();
        initClouds();
        gameLoop();
        highScoreDisplay.textContent = `High Score: ${game.highScore}`;
        
        // Instructions update
        document.addEventListener('touchstart', function() {
            if (game.running) {
                instructions.textContent = "Keep tapping! Watch the gap size";
            }
        }, { once: true });
    </script>
</body>
</html>
